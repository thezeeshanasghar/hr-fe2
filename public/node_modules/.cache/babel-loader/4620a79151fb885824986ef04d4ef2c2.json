{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n}; // TODO: enterprise connections should not depend on database\n// connections. However, we now allow a username input to contain also\n// an email and this information is in the database module. We should\n// make this information flow from the UI (like we do for the startHRD\n// function). Including this dependency here allows us to do that\n// incrementally.\n\n\nexports.startHRD = startHRD;\nexports.cancelHRD = cancelHRD;\nexports.logIn = logIn;\n\nvar _index = require('../../store/index');\n\nvar _enterprise = require('../enterprise');\n\nvar _index2 = require('../../field/index');\n\nvar _email = require('../../field/email');\n\nvar _actions = require('../../core/actions');\n\nvar _index3 = require('../../core/index');\n\nvar l = _interopRequireWildcard(_index3);\n\nvar _index4 = require('../database/index');\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction startHRD(id, email) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, _enterprise.toggleHRD, email);\n}\n\nfunction cancelHRD(id) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    m = (0, _enterprise.toggleHRD)(m, false);\n    m = (0, _index2.hideInvalidFields)(m);\n    return m;\n  });\n}\n\nfunction getConnectionScopesFrom(m, connection) {\n  var connectionScopes = l.auth.connectionScopes(m);\n  return connectionScopes.get(connection.get('name'));\n}\n\nfunction logIn(id) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  var email = (0, _index2.getFieldValue)(m, (0, _index4.databaseLogInWithEmail)(m) ? 'email' : 'username');\n  var ssoConnection = (0, _enterprise.matchConnection)(m, email);\n  var enterpriseConnection = (0, _enterprise.enterpriseActiveFlowConnection)(m);\n  var connectionScopes = getConnectionScopesFrom(m, ssoConnection || enterpriseConnection);\n  var params = {\n    connection_scope: connectionScopes ? connectionScopes.toJS() : undefined\n  };\n\n  if (ssoConnection && !(0, _enterprise.isHRDActive)(m)) {\n    return logInSSO(id, ssoConnection, params);\n  }\n\n  logInActiveFlow(id, params);\n}\n\nfunction logInActiveFlow(id, params) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  var usernameField = (0, _enterprise.isHRDActive)(m) || !(0, _index4.databaseLogInWithEmail)(m) ? 'username' : 'email';\n  var originalUsername = (0, _index2.getFieldValue)(m, usernameField);\n  var connection = (0, _enterprise.enterpriseActiveFlowConnection)(m);\n  var username = l.defaultADUsernameFromEmailPrefix(m) ? (0, _email.emailLocalPart)(originalUsername) : originalUsername;\n  (0, _actions.logIn)(id, ['password', usernameField], _extends({}, params, {\n    connection: connection ? connection.get('name') : null,\n    username: username,\n    password: (0, _index2.getFieldValue)(m, 'password'),\n    login_hint: username\n  }));\n}\n\nfunction logInSSO(id, connection, params) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  var field = (0, _index4.databaseLogInWithEmail)(m) ? 'email' : 'username';\n  l.emitEvent(m, 'sso login', {\n    lockID: id,\n    connection: connection,\n    field: field\n  });\n  (0, _actions.logIn)(id, [field], _extends({}, params, {\n    connection: connection.get('name'),\n    login_hint: (0, _index2.getFieldValue)(m, field)\n  }));\n}","map":{"version":3,"sources":["E:/employee management system/hr/new theme/Fuse-React-v5.2.1-skeleton/node_modules/auth0-lock/lib/connection/enterprise/actions.js"],"names":["exports","__esModule","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","startHRD","cancelHRD","logIn","_index","require","_enterprise","_index2","_email","_actions","_index3","l","_interopRequireWildcard","_index4","obj","newObj","default","id","email","swap","updateEntity","toggleHRD","m","hideInvalidFields","getConnectionScopesFrom","connection","connectionScopes","auth","get","read","getEntity","getFieldValue","databaseLogInWithEmail","ssoConnection","matchConnection","enterpriseConnection","enterpriseActiveFlowConnection","params","connection_scope","toJS","undefined","isHRDActive","logInSSO","logInActiveFlow","usernameField","originalUsername","username","defaultADUsernameFromEmailPrefix","emailLocalPart","password","login_hint","field","emitEvent","lockID"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n// TODO: enterprise connections should not depend on database\n// connections. However, we now allow a username input to contain also\n// an email and this information is in the database module. We should\n// make this information flow from the UI (like we do for the startHRD\n// function). Including this dependency here allows us to do that\n// incrementally.\n\n\nexports.startHRD = startHRD;\nexports.cancelHRD = cancelHRD;\nexports.logIn = logIn;\n\nvar _index = require('../../store/index');\n\nvar _enterprise = require('../enterprise');\n\nvar _index2 = require('../../field/index');\n\nvar _email = require('../../field/email');\n\nvar _actions = require('../../core/actions');\n\nvar _index3 = require('../../core/index');\n\nvar l = _interopRequireWildcard(_index3);\n\nvar _index4 = require('../database/index');\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction startHRD(id, email) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, _enterprise.toggleHRD, email);\n}\n\nfunction cancelHRD(id) {\n  (0, _index.swap)(_index.updateEntity, 'lock', id, function (m) {\n    m = (0, _enterprise.toggleHRD)(m, false);\n    m = (0, _index2.hideInvalidFields)(m);\n    return m;\n  });\n}\n\nfunction getConnectionScopesFrom(m, connection) {\n  var connectionScopes = l.auth.connectionScopes(m);\n  return connectionScopes.get(connection.get('name'));\n}\n\nfunction logIn(id) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  var email = (0, _index2.getFieldValue)(m, (0, _index4.databaseLogInWithEmail)(m) ? 'email' : 'username');\n  var ssoConnection = (0, _enterprise.matchConnection)(m, email);\n  var enterpriseConnection = (0, _enterprise.enterpriseActiveFlowConnection)(m);\n  var connectionScopes = getConnectionScopesFrom(m, ssoConnection || enterpriseConnection);\n\n  var params = {\n    connection_scope: connectionScopes ? connectionScopes.toJS() : undefined\n  };\n\n  if (ssoConnection && !(0, _enterprise.isHRDActive)(m)) {\n    return logInSSO(id, ssoConnection, params);\n  }\n\n  logInActiveFlow(id, params);\n}\n\nfunction logInActiveFlow(id, params) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  var usernameField = (0, _enterprise.isHRDActive)(m) || !(0, _index4.databaseLogInWithEmail)(m) ? 'username' : 'email';\n\n  var originalUsername = (0, _index2.getFieldValue)(m, usernameField);\n  var connection = (0, _enterprise.enterpriseActiveFlowConnection)(m);\n\n  var username = l.defaultADUsernameFromEmailPrefix(m) ? (0, _email.emailLocalPart)(originalUsername) : originalUsername;\n\n  (0, _actions.logIn)(id, ['password', usernameField], _extends({}, params, {\n    connection: connection ? connection.get('name') : null,\n    username: username,\n    password: (0, _index2.getFieldValue)(m, 'password'),\n    login_hint: username\n  }));\n}\n\nfunction logInSSO(id, connection, params) {\n  var m = (0, _index.read)(_index.getEntity, 'lock', id);\n  var field = (0, _index4.databaseLogInWithEmail)(m) ? 'email' : 'username';\n\n  l.emitEvent(m, 'sso login', {\n    lockID: id,\n    connection: connection,\n    field: field\n  });\n\n  (0, _actions.logIn)(id, [field], _extends({}, params, {\n    connection: connection.get('name'),\n    login_hint: (0, _index2.getFieldValue)(m, field)\n  }));\n}\n"]},"metadata":{},"sourceType":"script"}